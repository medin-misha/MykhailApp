# MykhailApp

MykhailApp ‚Äî —ç—Ç–æ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–µ—Ä–≤–∏—Å–æ–≤, API-–∫–ª—é—á–µ–π, –ø–æ–¥–ø–∏—Å–æ–∫ –∏ –ø–ª–∞—Ç–µ–∂–µ–π.  
–û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ —É—á—ë—Ç–∞ –¥–ª—è –≤—Å–µ—Ö –≤–∞—à–∏—Ö Telegram Mini Apps, –±–æ—Ç–æ–≤ –∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö —á–µ—Ä–µ–∑ AMQP (RabbitMQ).

–°–µ—Ä–≤–∏—Å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è, –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∏—Ö –ø–æ API-–∫–ª—é—á—É –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–§–∞–π–ª `.env` –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `/app`:

```env
rabbit_url = "amqps://login:password@dog.lmq.cloudamqp.com/khllqnbg"
postgres_url = "postgresql+asyncpg://login:password@mykhail-postgres-medinskijmisa228-e66a.k.aivencloud.com:23233/defaultdb"
# –í–∞–∂–Ω–æ: —Å—Ç—Ä–æ–∫–∞ postgres_url –î–û–õ–ñ–ù–ê –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä–∞–π–≤–µ—Ä postgresql+asyncpg
```

### 2. –°—Ç–∞—Ä—Ç
```commandline
uv run main.py
```

‚úÖ –ü–µ—Ä–≤–∏—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å:

#### 1. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä

POST /api/v1/admins/
```json
{
  "username": "string",
  "email": "user@example.com",
  "role": "manager",
  "is_active": true,
  "password": "string"
}
```
#### 2. –°–µ—Ä–≤–∏—Å

POST /api/v1/services
```json
{
  "name": "string",
  "description": "string",
  "owner_id": 0
}
```
#### 3. API-–∫–ª—é—á —Å–µ—Ä–≤–∏—Å–∞

POST /api/v1/api-keys
```json
{
  "service_id": 0,
  "description": "string",
  "is_active": true,
  "admin_password": "string"
}
```

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è API-–∫–ª—é—á–∞ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ RabbitMQ.

#### üì® –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–æ AMQP

MykhailApp —Ä–∞–±–æ—Ç–∞–µ—Ç —Å RabbitMQ –∏ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –æ—á–µ—Ä–µ–¥–µ–π.
–í–æ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞–ª–∏—á–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –ø–æ–ª–µ–π meta.*.

##### üì• user.registered

–û—á–µ—Ä–µ–¥—å: user.registered
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
```json
{
  "event": "user.registered",
  "version": "1.0",
  "data": {
    "chat_id": 0,
    "username": "string",
    "phone": "string",
    "email": "user@example.com",
    "birthday_date": "2025-11-03",
    "language": "ru"
  },
  "meta": {
    "sent_at": "2025-10-26T08:00:00Z",
    "api_key": "abcdef123456",
    "service_id": 2
  }
}
```

‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
data.chat_id, data.username, –∏ –í–°–ï –ø–æ–ª—è –≤ meta.

##### üì• user.updated

–û—á–µ—Ä–µ–¥—å: user.updated
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
```json
{
  "event": "user.updated",
  "version": "1.0",
  "data": {
    "chat_id": 123456789,
    "username": "misha2",
    "language": "en"
  },
  "meta": {
    "sent_at": "2025-10-26T08:00:00Z",
    "service_id": 2,
    "api_key": "dhpBhBtCoIN2meODvfmb_AgZyCCRS-rz3v_pHLIAhoE"
  }
}
```
##### üì• subscription.created

–û—á–µ—Ä–µ–¥—å: subscription.created
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ä–∞–º–∫–∞—Ö —Å–µ—Ä–≤–∏—Å–∞.
```json
{
  "event": "subscription.created",
  "version": "1.0",
  "data": {
    "chat_id": 123456789,
    "source": "tribute",
    "subscription_id": 2
  },
  "meta": {
    "sent_at": "2025-10-26T08:00:00Z",
    "api_key": "abcdef123456",
    "service_id": 2
  }
}
```
##### üì• payment.received

–û—á–µ—Ä–µ–¥—å: payment.received
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ø–µ—Ä–µ–¥–∞—á–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–ª–∞—Ç–µ–∂–µ.

```json
{
  "event": "payment.received",
  "version": "1.0",
  "data": {
    "chat_id": 123456789,
    "payment_id": "pay_00123",
    "amount": "4.99",
    "currency": "EUR",
    "provider": "tribute",
    "status": "succeeded",
    "provider_payload": {}
  },
  "meta": {
    "service_id": 2,
    "sent_at": "2025-10-26T08:01:00Z",
    "api_key": "abcdef123456"
  }
}
```

‚úÖ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Å–æ–æ–±—â–µ–Ω–∏–π

–ü–æ–ª–µ meta –≤—Å–µ–≥–¥–∞ –æ–±—è–∑–∞–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å:

–ü–æ–ª–µ	–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
api_key	–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞
service_id	–ø—Ä–∏–≤—è–∑–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Å–µ—Ä–≤–∏—Å—É
sent_at	–≤—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è

–ï—Å–ª–∏ api_key –∏–ª–∏ service_id –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è.

üß© –û–±—â–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
- –í–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å –ø–æ–ª—É—á–∞–µ—Ç API-–∫–ª—é—á.
- –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ RabbitMQ.
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ.
MykhailApp:
- –ø—Ä–æ–≤–µ—Ä—è–µ—Ç api_key,
- –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–æ–±—ã—Ç–∏—è,
- —Å–æ–∑–¥–∞—ë—Ç/–æ–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è,
- –≤–µ–¥—ë—Ç —É—á—ë—Ç –ø–æ–¥–ø–∏—Å–æ–∫ –∏ –ø–ª–∞—Ç–µ–∂–µ–π.
- –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, MykhailApp —Å–ª—É–∂–∏—Ç –∫–∞–∫ –µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ —É—á—ë—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø–æ–¥–ø–∏—Å–æ–∫ –¥–ª—è –≤—Å–µ—Ö –≤–∞—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.